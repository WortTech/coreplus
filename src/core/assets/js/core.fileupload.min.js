// Helper function to help with the file upload logic.  There is a small amount of javascript for "prettifying"
Core.fileupload=function(h){var a=$("#"+h+"-selector"),b=$("#"+h+"-actions"),e=a.find(":checked").attr("selectortype"),d={current:a.find(".fileinput-selector[selectortype=current]"),upload:a.find(".fileinput-selector[selectortype=upload]"),link:a.find(".fileinput-selector[selectortype=link]"),browse:a.find(".fileinput-selector[selectortype=browse]"),none:a.find(".fileinput-selector[selectortype=none]")},g={current:b.find(".fileinput-action[selectortype=current]"),upload:b.find(".fileinput-action[selectortype=upload]"),link:b.find(".fileinput-action[selectortype=link]"),browse:b.find(".fileinput-action[selectortype=browse]"),none:b.find(".fileinput-action[selectortype=none]")},c=false,f=(($("#"+h).attr("accept")).indexOf("image/")===0?"image":"index");if(a.find(".fileinput-selector").length>1){a.show()}b.find(".fileinput-action").hide();b.show();g[e].show();if(e=="upload"){g.upload.find("input").removeAttr("disabled")}a.find(".fileinput-selector").click(function(){e=$(this).attr("selectortype");b.children(".fileinput-action").hide();g[e].show();switch(e){case"upload":g.upload.find("input").removeAttr("disabled");break;case"browse":if(!c){load_browser(Core.ROOT_URL+"mediamanagernavigator/"+f+"?mode=list&ajax=1&controls=0&uploader=0");c=true}g.upload.find("input").attr("disabled","disabled");break;default:g.upload.find("input").attr("disabled","disabled");break}});g.link.find("input").change(function(){d.link.val("_link_://"+this.value)});load_browser=function(i){g.browse.load(i,function(){Navigator.Setup();g.browse.find("a").click(function(){var j=$(this).attr("href");if(j!="#"){load_browser($(this).attr("href"));return false}});Navigator.SelectFile=function(j){d.browse.val("_browse_://"+j.attr("corename"));g.browse.find(".file.selected").removeClass("selected");j.closest(".file").addClass("selected");return false}})}};