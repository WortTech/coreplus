var logintimer,$container,$btn,checkresult;checkresult=function(b){var a,c;clearInterval(logintimer);if(b instanceof Object){c=$(b.responseText)}else{c=$(b)}if(c.find("#user-login-placeholder-for-javascript-because-otherpages-may-have-an-error").length>0){a=c.find(".message-error");$container.before(a);$container.replaceWith(c.find("#user-login"));initialize_form();return}$btn.removeAttr("disabled").val("OK!");Core.Reload()};initialize_form=function(){$container=$("#user-login");$btn=$container.find("input[type=submit]");$container.find("form").ajaxForm({beforeSubmit:function(){logintimer=setInterval(function(){if($btn.val()=="Processing ...."){$btn.val("Processing ")}else{$btn.val($btn.val()+".")}},250);$(".message-error").fadeOut("slow",function(){$(this).remove()});$btn.attr("disabled","disabled").val("Processing ")},success:checkresult,error:checkresult})};$(function(){if(Core.Url!="/user/login"&&Core.Url!="/user/register"&&Core.Url!="/user/register2"){$(".user-login form").submit(function(){$(this).find(":input[name=redirect]").val(window.location.href)});$(".user-register form").submit(function(){$(this).find(":input[name=redirect]").val(window.location.href)})}$("#formtextinput-email").focus();initialize_form()});