$(function(){var c=$("body"),d={proxyIcon:"cog",proxyIconAnimation:"spin",proxyText:"Controls",proxyForce:null,position:"right"},e=null,b=null,f=null,a=Core.Browser.is_mobile;$(".controls").each(function(){var j=$(this),n=j.clone(),h=n.find("li").length,k={proxyIcon:j.data("proxy-icon"),proxyText:j.data("proxy-text"),proxyForce:j.data("proxy-force"),position:j.data("position"),proxyIconAnimation:j.data("proxy-icon-animation")},m,g,l;if(j.data("spin")){k.proxyIconAnimation="spin"}else{if(j.data("bounce")){k.proxyIconAnimation="bounce"}else{if(j.data("float")){k.proxyIconAnimation="float"}}}for(m in k){if(k[m]===undefined){k[m]=d[m]}}j.data("position",k.position);j.parent().append(n);c.append(j);j.addClass("context-menu").addClass("controls-hover");if(h==1){j.addClass("context-menu-one-link")}else{j.addClass("context-menu-many-links")}j.css("min-width",n.width());j.hide();if((k.proxyForce===null&&h>3)||k.proxyForce===true||k.proxyForce===1||k.proxyForce==="1"){l=true}else{l=false}if(l){g="controls-proxy-icon icon-"+k.proxyIcon;if(k.proxyIconAnimation){g+=" icon-"+k.proxyIconAnimation;n.addClass("controls-animated")}n.addClass("controls-proxy").html('<li><i class="'+g+'"></i>'+(k.proxyText?" "+k.proxyText:"")+"</li>")}if(k.proxyIconAnimation){setTimeout(function(i){i.find(".controls-proxy-icon").removeClass("icon-"+k.proxyIconAnimation)},1000,n)}n.mouseenter(function(){var r=n.offset(),t=$("body").width(),q=5,o=j.data("position"),s,i,p;if(e){e.hide()}if(o==="bottom"){s={top:(r.top+n.height())+"px",left:r.left+"px"}}else{s={top:r.top+"px",left:(r.left+n.innerHeight())+"px"}}j.css(s);j.show();i=j.offset();p=j.width();if(i.left+p+q>t){j.css({left:(t-q-p)+"px"})}e=j;b=n;if(k.proxyIconAnimation){b.find(".controls-proxy-icon").addClass("icon-"+k.proxyIconAnimation);setTimeout(function(u){u.find(".controls-proxy-icon").removeClass("icon-"+k.proxyIconAnimation)},1000,b)}}).mouseleave(function(){if(f){clearTimeout(f)}f=setTimeout(function(){if(b==null&&e){e.fadeOut()}},500);b=null});j.mouseenter(function(){b=j}).mouseleave(function(){b=null;if(f){clearTimeout(f)}f=setTimeout(function(){if(b==null&&e){e.fadeOut()}},500)});if(a){j.click(function(i){$(this).toggleClass("controls-open");if($(this).hasClass("controls-open")){i.preventDefault()}})}})});