// jQuery File Upload AngularJS Plugin 1.4.0
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","angular","./jquery.fileupload-image","./jquery.fileupload-audio","./jquery.fileupload-video","./jquery.fileupload-validate"],a)}else{a()}}(function(){angular.module("blueimp.fileupload",[]).provider("fileUpload",function(){var a=function(){var c=angular.element(this).fileupload("option","scope")();if(!c.$$phase){c.$apply()}},b;b=this.defaults={handleResponse:function(f,d){var c=d.result&&d.result.files;if(c){d.scope().replace(d.files,c)}else{if(d.errorThrown||d.textStatus==="error"){d.files[0].error=d.errorThrown||d.textStatus}}},add:function(f,d){var c=d.scope();d.process(function(){return c.process(d)}).always(function(){var g=d.files[0],h=function(){return d.submit()},e;for(e=0;e<d.files.length;e+=1){d.files[e]._index=e}g.$cancel=function(){c.clear(d.files);return d.abort()};g.$state=function(){return d.state()};g.$progress=function(){return d.progress()};g.$response=function(){return d.response()};if(g.$state()==="rejected"){g._$submit=h}else{g.$submit=h}c.$apply(function(){var i=c.option("prependFiles")?"unshift":"push";Array.prototype[i].apply(c.queue,d.files);if(g.$submit&&(c.option("autoUpload")||d.autoUpload)&&d.autoUpload!==false){g.$submit()}})})},progress:function(d,c){c.scope().$apply()},done:function(f,d){var c=this;d.scope().$apply(function(){d.handleResponse.call(c,f,d)})},fail:function(f,d){var c=this;if(d.errorThrown==="abort"){return}if(d.dataType&&d.dataType.indexOf("json")===d.dataType.length-4){try{d.result=angular.fromJson(d.jqXHR.responseText)}catch(g){}}d.scope().$apply(function(){d.handleResponse.call(c,f,d)})},stop:a,processstart:a,processstop:a,getNumberOfFiles:function(){return this.scope().queue.length},dataType:"json",prependFiles:true,autoUpload:false};this.$get=[function(){return{defaults:b}}]}).provider("formatFileSizeFilter",function(){var a={units:[{size:1000000000,suffix:" GB"},{size:1000000,suffix:" MB"},{size:1000,suffix:" KB"}]};this.defaults=a;this.$get=function(){return function(b){if(!angular.isNumber(b)){return""}var d=true,c=0,e,f;while(d){d=a.units[c];e=d.prefix||"";f=d.suffix||"";if(c===a.units.length-1||b>=d.size){return e+(b/d.size).toFixed(2)+f}c+=1}}}}).controller("FileUploadController",["$scope","$element","$attrs","$window","fileUpload",function(c,b,a,f,d){var e={progress:function(){return b.fileupload("progress")},active:function(){return b.fileupload("active")},option:function(g,h){return b.fileupload("option",g,h)},add:function(g){return b.fileupload("add",g)},send:function(g){return b.fileupload("send",g)},process:function(g){return b.fileupload("process",g)},processing:function(g){return b.fileupload("processing",g)}};c.disabled=!f.jQuery.support.fileInput;c.queue=c.queue||[];c.clear=function(l){var g=this.queue,j=g.length,h=l,k=1;if(angular.isArray(l)){h=l[0];k=l.length}while(j){j-=1;if(g[j]===h){return g.splice(j,k)}}};c.replace=function(h,n){var g=this.queue,m=h[0],l,k;for(l=0;l<g.length;l+=1){if(g[l]===m){for(k=0;k<n.length;k+=1){g[l+k]=n[k]}return}}};c.applyOnQueue=function(k){var j=this.queue.slice(0),h,g;for(h=0;h<j.length;h+=1){g=j[h];if(g[k]){g[k]()}}};c.submit=function(){this.applyOnQueue("$submit")};c.cancel=function(){this.applyOnQueue("$cancel")};angular.extend(c,e);b.fileupload(angular.extend({scope:function(){return c}},d.defaults)).on("fileuploadadd",function(h,g){g.scope=c.option("scope")}).on(["fileuploadadd","fileuploadsubmit","fileuploadsend","fileuploaddone","fileuploadfail","fileuploadalways","fileuploadprogress","fileuploadprogressall","fileuploadstart","fileuploadstop","fileuploadchange","fileuploadpaste","fileuploaddrop","fileuploaddragover","fileuploadchunksend","fileuploadchunkdone","fileuploadchunkfail","fileuploadchunkalways","fileuploadprocessstart","fileuploadprocess","fileuploadprocessdone","fileuploadprocessfail","fileuploadprocessalways","fileuploadprocessstop"].join(" "),function(h,g){c.$emit(h.type,g)}).on("remove",function(){var g;for(g in e){if(e.hasOwnProperty(g)){delete c[g]}}});c.$watch(a.fileUpload,function(g){if(g){b.fileupload("option",g)}})}]).controller("FileUploadProgressController",["$scope","$attrs","$parse",function(b,a,d){var c=d(a.fileUploadProgress),e=function(){var f=c(b);if(!f||!f.total){return}b.num=Math.floor(f.loaded/f.total*100)};e();b.$watch(a.fileUploadProgress+".loaded",function(g,f){if(g!==f){e()}})}]).controller("FileUploadPreviewController",["$scope","$element","$attrs","$parse",function(c,b,a,f){var e=f(a.fileUploadPreview),d=e(c);if(d.preview){b.append(d.preview)}}]).directive("fileUpload",function(){return{controller:"FileUploadController"}}).directive("fileUploadProgress",function(){return{controller:"FileUploadProgressController"}}).directive("fileUploadPreview",function(){return{controller:"FileUploadPreviewController"}}).directive("download",function(){return function(a,b){b.on("dragstart",function(c){try{c.originalEvent.dataTransfer.setData("DownloadURL",["application/octet-stream",b.prop("download"),b.prop("href")].join(":"))}catch(d){}})}})}));