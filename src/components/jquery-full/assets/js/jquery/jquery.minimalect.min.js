(function(e,c,a,g){var d="minimalect",f={theme:"",transition:"fade",remove_empty_option:false,placeholder:"Select a choice",empty:"No results match your keyword.",class_container:"minict_wrapper",class_group:"minict_group",class_empty:"minict_empty",class_active:"active",class_selected:"selected",class_hidden:"hidden",class_highlighted:"highlighted",class_first:"minict_first",class_last:"minict_last",beforeinit:function(){},afterinit:function(){},onchange:function(){},onopen:function(){},onclose:function(){},onfilter:function(){}};function b(i,h){this.element=e(i);this.options=e.extend({},f,h);this._defaults=f;this._name=d;this.label=e('[for="'+this.element.attr("id")+'"]').attr("for","minict_"+this.element.attr("id"));this.init()}b.prototype={init:function(){this.options.beforeinit();var h=this;this.wrapper=e('<div class="'+this.options.class_container+'"></div>');this.element.hide().after(this.wrapper);if(this.options.theme){this.wrapper.addClass(this.options.theme)}this.input=e('<input type="text" value="'+(this.element.find("option[selected]").html()||"")+'" placeholder="'+(this.element.find("option[selected]").html()||this.options.placeholder)+'" '+(this.element.is("[tabindex]")?("tabindex="+this.element.attr("tabindex")):"")+" />").appendTo(this.wrapper);this.ul=e("<ul>"+h.parseSelect()+'<li class="'+h.options.class_empty+'">'+h.options.empty+"</li></ul>").appendTo(this.wrapper);this.items=this.wrapper.find("li");if(this.element.find("option[selected]").length){this.items.filter('[data-value="'+this.element.find("option[selected]").val()+'"]').addClass(h.options.class_selected)}h.element.on("change",function(){var j=h.items.filter("."+h.options.class_selected),i=h.parseSelect();if(h.element.val()!=j.data("value")){h.hideChoices(h.wrapper,function(){if(h.element.val()===""){h.input.val("").attr("placeholder",h.options.placeholder)}else{h.ul.html(i+'<li class="'+h.options.class_empty+'">'+h.options.empty+"</li>");h.items=h.wrapper.find("li");h.selectChoice(h.items.filter('[data-value="'+h.element.val()+'"]'))}})}});e(a).on("click",function(){h.hideChoices(h.wrapper)});e("*").not(h.wrapper).not(h.wrapper.find("*")).on("focus",function(){h.hideChoices(h.wrapper)});this.wrapper.on("click",function(i){i.stopPropagation();h.toggleChoices()});this.label.on("click",function(i){i.stopPropagation();h.input.trigger("focus")});this.wrapper.on("click","li:not(."+h.options.class_group+", ."+h.options.class_empty+")",function(){h.selectChoice(e(this))});this.wrapper.on("click","li."+h.options.class_group+", li."+h.options.class_empty,function(i){i.stopPropagation();h.input.focus()});this.input.on("focus click",function(i){i.stopPropagation();h.showChoices()}).on("keydown",function(i){switch(i.keyCode){case 38:h.navigateChoices("up");break;case 40:h.navigateChoices("down");break;case 13:case 9:if(h.items.filter("."+h.options.class_highlighted).length){h.selectChoice(h.items.filter("."+h.options.class_highlighted))}else{if(h.input.val()){h.selectChoice(h.items.not("."+h.options.class_group+", ."+h.options.class_empty).filter(":visible").first())}}if(i.keyCode===13){i.preventDefault();h.hideChoices(h.wrapper)}break;case 27:h.hideChoices(h.wrapper);break}}).on("keyup",function(i){if(e.inArray(i.keyCode,[38,40,13,9,27])===-1){h.filterChoices()}});this.options.afterinit()},navigateChoices:function(i){var k=this,p=k.wrapper,n=k.options,q=k.items;var j="."+n.class_hidden+", ."+n.class_empty+", ."+n.class_group;if(!q.filter("."+n.class_highlighted).length){if(i==="up"){q.not(j).last().addClass(n.class_highlighted)}else{if(i==="down"){q.not(j).first().addClass(n.class_highlighted)}}return false}else{cur=q.filter("."+n.class_highlighted);cur.removeClass(n.class_highlighted);if(i==="up"){if(q.not(j).first()[0]!=cur[0]){cur.prevAll("li").not(j).first().addClass(n.class_highlighted);var l=q.filter("."+n.class_highlighted).offset().top-k.ul.offset().top+k.ul.scrollTop();if(k.ul.scrollTop()>l){k.ul.scrollTop(l)}}else{q.not(j).last().addClass(n.class_highlighted);k.ul.scrollTop(k.ul.height())}}else{if(i==="down"){if(q.not(j).last()[0]!=cur[0]){cur.nextAll("li").not(j).first().addClass(n.class_highlighted);var h=k.ul.height(),o=q.filter("."+n.class_highlighted).offset().top-k.ul.offset().top+q.filter("."+n.class_highlighted).outerHeight();if(h<o){k.ul.scrollTop(k.ul.scrollTop()+o-h)}}else{q.not(j).first().addClass(n.class_highlighted);k.ul.scrollTop(0)}}}}},parseSelect:function(){var h=this,i="";if(!h.element.find("optgroup").length){i=this.parseElements(h.element.html())}else{h.element.find("optgroup").each(function(){i+='<li class="'+h.options.class_group+'">'+e(this).attr("label")+"</li>";i+=h.parseElements(e(this).html())})}return i},parseElements:function(i){var h=this,j="";e(e.trim(i)).filter("option").each(function(){var k=e(this);if(k.attr("value")===""&&h.options.remove_empty_option){return}j+='<li data-value="'+k.val()+'" class="'+(k.attr("class")||"")+'">'+k.text()+"</li>"});return j},toggleChoices:function(){(!this.wrapper.hasClass(this.options.class_active))?this.showChoices():this.hideChoices(this.wrapper)},showChoices:function(i){var h=this,j=this.wrapper,k=this.options;if(!j.hasClass(k.class_active)){this.updateFirstLast(false);e("."+k.class_container).each(function(){if(e(this)[0]!==j[0]){h.hideChoices(e(this))}});if(typeof i==="function"){i.call()}j.addClass(k.class_active);switch(k.transition){case"fade":h.ul.fadeIn(150);break;default:h.ul.show();break}this.input.val("").focus();this.options.onopen()}else{if(typeof i==="function"){i.call()}}},resetDropdown:function(h){var i=this.options;this.items.removeClass(i.class_hidden);this.wrapper.find("."+i.class_empty).hide();this.items.filter("."+i.class_highlighted).removeClass(i.class_highlighted);if(typeof h==="function"){h.call()}},hideChoices:function(j,h){var k=this.options,i=j.find("input");if(j.hasClass(k.class_active)){j.removeClass(k.class_active);switch(k.transition){case"fade":j.children("ul").fadeOut(100);break;default:j.children("ul").hide();break}this.resetDropdown(h);i.blur();if(i.attr("placeholder")!=k.placeholder){i.val(i.attr("placeholder"))}else{if(!this.items.filter("."+k.class_selected).length){i.val("")}}k.onclose()}else{if(typeof h==="function"){h.call()}}},filterChoices:function(){var h=this.wrapper,j=this.options;var i=this.input.val();this.items.filter("."+j.class_highlighted).removeClass(j.class_highlighted);this.items.not(j.class_group).each(function(){if(e(this).text().search(new RegExp(i,"i"))<0){e(this).addClass(j.class_hidden)}else{e(this).removeClass(j.class_hidden)}});this.items.filter("."+j.class_group).removeClass(j.class_hidden).each(function(){nextlis=e(this).nextAll("li").not("."+j.class_hidden+", ."+j.class_empty);if(nextlis.first().hasClass(j.class_group)||!nextlis.length){e(this).addClass(j.class_hidden)}});h.find("."+j.class_empty).hide();if(!this.items.not("."+j.class_hidden+", ."+j.class_empty).length){h.find("."+j.class_empty).show();this.options.onfilter(false)}else{this.options.onfilter(true)}this.updateFirstLast(true)},selectChoice:function(i){var h=this.element,j=this.options;this.items.removeClass(j.class_selected);i.addClass(j.class_selected);if(!i.data("value")){this.input.val("").attr("placeholder",j.placeholder)}else{this.input.val(i.text()).attr("placeholder",i.text())}if(h.find("option:selected").val()!=i.data("value")){h.find("option:selected").prop("selected",false);h.find('option[value="'+i.data("value")+'"]').prop("selected",true);h.trigger("change")}this.options.onchange(i.data("value"),i.text())},updateFirstLast:function(i){var h=this.wrapper,j=this.options;h.find("."+j.class_first+", ."+j.class_last).removeClass(j.class_first+" "+j.class_last);if(i){this.items.filter(":visible").first().addClass(j.class_first);this.items.filter(":visible").last().addClass(j.class_last)}else{this.items.first().addClass(j.class_first);this.items.not("."+j.class_empty).last().addClass(j.class_last)}}};e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))}})}})(jQuery,window,document);