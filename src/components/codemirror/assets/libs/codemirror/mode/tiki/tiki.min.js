CodeMirror.defineMode("tiki",function(u){function t(y,x,w){return function(A,z){while(!A.eol()){if(A.match(x)){z.tokenize=m;break}A.next()}if(w){z.tokenize=w}return y}}function l(w){return function(y,x){while(!y.eol()){y.next()}x.tokenize=m;return w}}function m(B,A){function x(D){A.tokenize=D;return D(B,A)}var z=B.sol();var y=B.next();switch(y){case"{":B.eat("/");B.eatSpace();var w="";var C;while((C=B.eat(/[^\s\u00a0=\"\'\/?(}]/))){w+=C}A.tokenize=v;return"tag";break;case"_":if(B.eat("_")){return x(t("strong","__",m))}break;case"'":if(B.eat("'")){return x(t("em","''",m))}break;case"(":if(B.eat("(")){return x(t("variable-2","))",m))}break;case"[":return x(t("variable-3","]",m));break;case"|":if(B.eat("|")){return x(t("comment","||"))}break;case"-":if(B.eat("=")){return x(t("header string","=-",m))}else{if(B.eat("-")){return x(t("error tw-deleted","--",m))}}break;case"=":if(B.match("==")){return x(t("tw-underline","===",m))}break;case":":if(B.eat(":")){return x(t("comment","::"))}break;case"^":return x(t("tw-box","^"));break;case"~":if(B.match("np~")){return x(t("meta","~/np~"))}break}if(z){switch(y){case"!":if(B.match("!!!!!")){return x(l("header string"))}else{if(B.match("!!!!")){return x(l("header string"))}else{if(B.match("!!!")){return x(l("header string"))}else{if(B.match("!!")){return x(l("header string"))}else{return x(l("header string"))}}}}break;case"*":case"#":case"+":return x(l("tw-listitem bracket"));break}}return null}var n=u.indentUnit;var a,f;function v(z,y){var x=z.next();var w=z.peek();if(x=="}"){y.tokenize=m;return"tag"}else{if(x=="("||x==")"){return"bracket"}else{if(x=="="){f="equals";if(w==">"){x=z.next();w=z.peek()}if(!/[\'\"]/.test(w)){y.tokenize=r()}return"operator"}else{if(/[\'\"]/.test(x)){y.tokenize=i(x);return y.tokenize(z,y)}else{z.eatWhile(/[^\s\u00a0=\"\'\/?]/);return"keyword"}}}}}function i(w){return function(y,x){while(!y.eol()){if(y.next()==w){x.tokenize=v;break}}return"string"}}function r(){return function(z,y){while(!z.eol()){var x=z.next();var w=z.peek();if(x==" "||x==","||/[ )}]/.test(w)){y.tokenize=v;break}}return"string"}}var j,g;function b(){for(var w=arguments.length-1;w>=0;w--){j.cc.push(arguments[w])}}function d(){b.apply(null,arguments);return true}function h(x,y){var w=j.context&&j.context.noIndent;j.context={prev:j.context,pluginName:x,indent:j.indented,startOfLine:y,noIndent:w}}function q(){if(j.context){j.context=j.context.prev}}function c(w){if(w=="openPlugin"){j.pluginName=a;return d(k,o(j.startOfLine))}else{if(w=="closePlugin"){var x=false;if(j.context){x=j.context.pluginName!=a;q()}else{x=true}if(x){g="error"}return d(e(x))}else{if(w=="string"){if(!j.context||j.context.name!="!cdata"){h("!cdata")}if(j.tokenize==m){q()}return d()}else{return d()}}}}function o(w){return function(x){if(x=="selfclosePlugin"||x=="endPlugin"){return d()}if(x=="endPlugin"){h(j.pluginName,w);return d()}return d()}}function e(w){return function(x){if(w){g="error"}if(x=="endPlugin"){return d()}return b()}}function k(w){if(w=="keyword"){g="attribute";return d(k)}if(w=="equals"){return d(s,k)}return b()}function s(w){if(w=="keyword"){g="string";return d()}if(w=="string"){return d(p)}return b()}function p(w){if(w=="string"){return d(p)}else{return b()}}return{startState:function(){return{tokenize:m,cc:[],indented:0,startOfLine:true,pluginName:null,context:null}},token:function(z,y){if(z.sol()){y.startOfLine=true;y.indented=z.indentation()}if(z.eatSpace()){return null}g=f=a=null;var x=y.tokenize(z,y);if((x||f)&&x!="comment"){j=y;while(true){var w=y.cc.pop()||c;if(w(f||x)){break}}}y.startOfLine=false;return g||x},indent:function(y,w){var x=y.context;if(x&&x.noIndent){return 0}if(x&&/^{\//.test(w)){x=x.prev}while(x&&!x.startOfLine){x=x.prev}if(x){return x.indent+n}else{return 0}},electricChars:"/"}});CodeMirror.defineMIME("text/tiki","tiki");