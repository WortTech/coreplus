// Author: Constantin Jucovschi (c.jucovschi@jacobs-university.de)
CodeMirror.defineMode("stex",function(){function i(l,m){l.cmdState.push(m)}function g(l){if(l.cmdState.length>0){return l.cmdState[l.cmdState.length-1]}else{return null}}function k(m){var l=m.cmdState.pop();if(l){l.closeBracket()}}function a(o){var n=o.cmdState;for(var m=n.length-1;m>=0;m--){var l=n[m];if(l.name=="DEFAULT"){continue}return l}return{styleIdentifier:function(){return null}}}function b(n,m,l){return function(){this.name=n;this.bracketNo=0;this.style=m;this.styles=l;this.argument=null;this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null};this.openBracket=function(){this.bracketNo++;return"bracket"};this.closeBracket=function(){}}}var c={};c.importmodule=b("importmodule","tag",["string","builtin"]);c.documentclass=b("documentclass","tag",["","atom"]);c.usepackage=b("usepackage","tag",["atom"]);c.begin=b("begin","tag",["atom"]);c.end=b("end","tag",["atom"]);c.DEFAULT=function(){this.name="DEFAULT";this.style="tag";this.styleIdentifier=this.openBracket=this.closeBracket=function(){}};function d(m,l){m.f=l}function e(p,o){var l;if(p.match(/^\\[a-zA-Z@]+/)){var m=p.current().slice(1);l=c[m]||c.DEFAULT;l=new l();i(o,l);d(o,f);return l.style}if(p.match(/^\\[$&%#{}_]/)){return"tag"}if(p.match(/^\\[,;!\/]/)){return"tag"}if(p.match("\\[")){d(o,function(r,q){return h(r,q,"\\]")});return"keyword"}if(p.match("$$")){d(o,function(r,q){return h(r,q,"$$")});return"keyword"}if(p.match("$")){d(o,function(r,q){return h(r,q,"$")});return"keyword"}var n=p.next();if(n=="%"){if(!p.eol()){d(o,j)}return"comment"}else{if(n=="}"||n=="]"){l=g(o);if(l){l.closeBracket(n);d(o,f)}else{return"error"}return"bracket"}else{if(n=="{"||n=="["){l=c.DEFAULT;l=new l();i(o,l);return"bracket"}else{if(/\d/.test(n)){p.eatWhile(/[\w.%]/);return"atom"}else{p.eatWhile(/[\w\-_]/);l=a(o);if(l.name=="begin"){l.argument=p.current()}return l.styleIdentifier()}}}}}function j(m,l){m.skipToEnd();d(l,e);return"comment"}function h(n,m,o){if(n.eatSpace()){return null}if(n.match(o)){d(m,e);return"keyword"}if(n.match(/^\\[a-zA-Z@]+/)){return"tag"}if(n.match(/^[a-zA-Z]+/)){return"variable-2"}if(n.match(/^\\[$&%#{}_]/)){return"tag"}if(n.match(/^\\[,;!\/]/)){return"tag"}if(n.match(/^[\^_&]/)){return"tag"}if(n.match(/^[+\-<>|=,\/@!*:;'"`~#?]/)){return null}if(n.match(/^(\d+\.\d*|\d*\.\d+|\d+)/)){return"number"}var l=n.next();if(l=="{"||l=="}"||l=="["||l=="]"||l=="("||l==")"){return"bracket"}if(l=="%"){if(!n.eol()){n.skipToEnd()}return"comment"}return"error"}function f(o,n){var m=o.peek(),l;if(m=="{"||m=="["){l=g(n);l.openBracket(m);o.eat(m);d(n,e);return"bracket"}if(/[ \t\r]/.test(m)){o.eat(m);return null}d(n,e);k(n);return e(o,n)}return{startState:function(){return{cmdState:[],f:e}},copyState:function(l){return{cmdState:l.cmdState.slice(),f:l.f}},token:function(m,l){return l.f(m,l)}}});CodeMirror.defineMIME("text/x-stex","stex");CodeMirror.defineMIME("text/x-latex","stex");