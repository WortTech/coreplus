CodeMirror.defineMode("smalltalk",function(c){var d=/[+\-\/\\*~<>=@%|&?!.:;^]/;var g=/true|false|nil|self|super|thisContext/;var h=function(l,k){this.next=l;this.parent=k};var b=function(k,l,m){this.name=k;this.context=l;this.eos=m};var i=function(){this.context=new h(f,null);this.expectVariable=true;this.indentation=0;this.userIndentationDelta=0};i.prototype.userIndent=function(k){this.userIndentationDelta=k>0?(k/c.indentUnit-this.indentation):0};var f=function(o,m,n){var l=new b(null,m,false);var k=o.next();if(k==='"'){l=a(o,new h(a,m))}else{if(k==="'"){l=j(o,new h(j,m))}else{if(k==="#"){o.eatWhile(/[^ .]/);l.name="string-2"}else{if(k==="$"){o.eatWhile(/[^ ]/);l.name="string-2"}else{if(k==="|"&&n.expectVariable){l.context=new h(e,m)}else{if(/[\[\]{}()]/.test(k)){l.name="bracket";l.eos=/[\[{(]/.test(k);if(k==="["){n.indentation++}else{if(k==="]"){n.indentation=Math.max(0,n.indentation-1)}}}else{if(d.test(k)){o.eatWhile(d);l.name="operator";l.eos=k!==";"}else{if(/\d/.test(k)){o.eatWhile(/[\w\d]/);l.name="number"}else{if(/[\w_]/.test(k)){o.eatWhile(/[\w\d_]/);l.name=n.expectVariable?(g.test(o.current())?"keyword":"variable"):null}else{l.eos=n.expectVariable}}}}}}}}}return l};var a=function(l,k){l.eatWhile(/[^"]/);return new b("comment",l.eat('"')?k.parent:k,true)};var j=function(l,k){l.eatWhile(/[^']/);return new b("string",l.eat("'")?k.parent:k,false)};var e=function(n,m){var l=new b(null,m,false);var k=n.next();if(k==="|"){l.context=m.parent;l.eos=true}else{n.eatWhile(/[^|]/);l.name="variable"}return l};return{startState:function(){return new i},token:function(m,l){l.userIndent(m.indentation());if(m.eatSpace()){return null}var k=l.context.next(m,l.context,l);l.context=k.context;l.expectVariable=k.eos;l.lastToken=k;return k.name},blankLine:function(k){k.userIndent(0)},indent:function(m,k){var l=m.context.next===f&&k&&k.charAt(0)==="]"?-1:m.userIndentationDelta;return(m.indentation+l)*c.indentUnit},electricChars:"]"}});CodeMirror.defineMIME("text/x-stsrc",{name:"smalltalk"});