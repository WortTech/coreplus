// theme.js
tinymce.ThemeManager.add("modern",function(g){var m=this,e=g.settings,c=tinymce.ui.Factory,k=tinymce.each,l=tinymce.DOM;var d={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}};var b="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";function j(){var o=[];function p(r){var s=[],q;if(!r){return}k(r.split(/[ ,]/),function(u){var v;function t(){var w=g.selection;if(v=="bullist"){w.selectorChanged("ul > li",function(z,x){var A,y=x.parents.length;while(y--){A=x.parents[y].nodeName;if(A=="OL"||A=="UL"){break}}u.active(A=="UL")})}if(v=="numlist"){w.selectorChanged("ol > li",function(z,x){var A,y=x.parents.length;while(y--){A=x.parents[y].nodeName;if(A=="OL"||A=="UL"){break}}u.active(A=="OL")})}if(u.settings.stateSelector){w.selectorChanged(u.settings.stateSelector,function(x){u.active(x)},true)}if(u.settings.disabledStateSelector){w.selectorChanged(u.settings.disabledStateSelector,function(x){u.disabled(x)})}}if(u=="|"){q=null}else{if(c.has(u)){u={type:u};if(e.toolbar_items_size){u.size=e.toolbar_items_size}s.push(u);q=null}else{if(!q){q={type:"buttongroup",items:[]};s.push(q)}if(g.buttons[u]){v=u;u=g.buttons[v];u.type=u.type||"button";if(e.toolbar_items_size){u.size=e.toolbar_items_size}u=c.create(u);q.items.push(u);if(g.initialized){t()}else{g.on("init",t)}}}}});o.push({type:"toolbar",layout:"flow",items:s});return true}for(var n=1;n<10;n++){if(!p(e["toolbar"+n])){break}}if(!o.length){p(e.toolbar||b)}return o}function i(){var p,u=[];function s(v){var w;if(v=="|"){return{text:"|"}}w=g.menuItems[v];return w}function n(z){var v,A,y,B,x;x=tinymce.makeMap((e.removed_menuitems||"").split(/[ ,]/));if(e.menu){A=e.menu[z];B=true}else{A=d[z]}if(A){v={text:A.title};y=[];k((A.items||"").split(/[ ,]/),function(D){var C=s(D);if(C&&!x[D]){y.push(s(D))}});if(!B){k(g.menuItems,function(C){if(C.context==z){if(C.separator=="before"){y.push({text:"|"})}if(C.prependToContext){y.unshift(C)}else{y.push(C)}if(C.separator=="after"){y.push({text:"|"})}}})}for(var w=0;w<y.length;w++){if(y[w].text=="|"){if(w===0||w==y.length-1){y.splice(w,1)}}}v.menu=y;if(!v.menu.length){return null}}return v}var o=[];if(e.menu){for(p in e.menu){o.push(p)}}else{for(p in d){o.push(p)}}var r=e.menubar?e.menubar.split(/[ ,]/):o;for(var q=0;q<r.length;q++){var t=r[q];t=n(t);if(t){u.push(t)}}return u}function f(o){function n(p){var q=o.find(p)[0];if(q){q.focus()}}g.shortcuts.add("Alt+F9","",function(){n("menubar")});g.shortcuts.add("Alt+F10","",function(){n("toolbar")});g.shortcuts.add("Alt+F11","",function(){n("elementpath")});o.on("cancel",function(){g.focus()})}function a(){var p;function o(){if(p&&p.visible()){var s=l.getPos(g.getBody());p.moveTo(s.x,s.y-p.layoutRect().h)}}function n(){if(p){p.show();o();l.addClass(g.getBody(),"mce-edit-focus")}}function q(){if(p){p.hide();l.removeClass(g.getBody(),"mce-edit-focus");if(document.activeElement&&document.activeElement.className.indexOf("mce-content-body")==-1){l.setStyle(document.body,"padding-top",0)}}}function r(){if(p){if(!p.visible()){n()}return}p=m.panel=c.create({type:"floatpanel",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",autohide:false,autofix:true,border:1,items:[e.menubar===false?null:{type:"menubar",border:"0 0 1 0",items:i()},{type:"panel",name:"toolbar",layout:"stack",items:j()}]});p.renderTo(document.body).reflow();f(p);n();g.on("nodeChange",o);g.on("activate",n);g.on("deactivate",q)}e.content_editable=true;g.on("focus",r);g.on("blur",q);g.on("remove",function(){p.remove();p=null});return{}}function h(o){var n;n=m.panel=c.create({type:"panel",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[e.menubar===false?null:{type:"menubar",border:"0 0 1 0",items:i()},{type:"panel",layout:"stack",items:j()},{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",html:"",border:"1 0 0 0"}]});if(e.statusbar!==false){n.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",items:[{type:"elementpath"},e.resize!==false?({type:"resizehandle",editor:g}):null]})}n.renderBefore(o.targetNode).reflow();if(e.width){tinymce.DOM.setStyle(n.getEl(),"width",e.width)}g.on("remove",function(){n.remove();n=null});f(n);return{iframeContainer:n.find("#iframe")[0].getEl(),editorContainer:n.getEl()}}m.renderUI=function(n){var o=e.skin!==false?e.skin||"lightgray":false;if(o){if(tinymce.Env.ie&&tinymce.Env.ie<=7){tinymce.DOM.loadCSS(tinymce.baseURL+"/skins/"+o+"/skin.ie7.min.css")}else{tinymce.DOM.loadCSS(tinymce.baseURL+"/skins/"+o+"/skin.min.css")}g.contentCSS.push(tinymce.baseURL+"/skins/"+o+"/content.min.css")}g.on("ProgressState",function(p){m.throbber=m.throbber||new tinymce.ui.Throbber(m.panel.getEl("body"));if(p.state){m.throbber.show(p.time)}else{m.throbber.hide()}});if(e.inline){return a(n)}return h(n)}});