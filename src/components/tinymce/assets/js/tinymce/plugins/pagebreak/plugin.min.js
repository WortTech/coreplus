// plugin.js
tinymce.PluginManager.add("pagebreak",function(e){var a="mce-pagebreak",b=e.getParam("pagebreak_separator","<!-- pagebreak -->"),d;var c='<img src="'+tinymce.Env.transparentSrc+'" class="'+a+'" data-mce-resize="false" />';d=new RegExp(b.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(f){return"\\"+f}),"g");e.addCommand("mcePageBreak",function(){e.execCommand("mceInsertContent",0,c)});e.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"});e.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"});e.on("ResolveName",function(f){if(f.target.nodeName=="IMG"&&e.dom.hasClass(f.target,a)){f.name="pagebreak"}});e.on("click",function(f){f=f.target;if(f.nodeName==="IMG"&&e.dom.hasClass(f,a)){e.selection.select(f)}});e.on("PreInit",function(){e.parser.addNodeFilter("#comment",function(g){var h=g.length,j,f;while(h--){j=g[h];if(j.value.indexOf("pagebreak")!==-1){f=new tinymce.html.Node("img",1);f.attr({src:tinymce.Env.transparentSrc,"class":"mce-pagebreak","data-mce-resize":"false"});j.replace(f)}}});e.serializer.addNodeFilter("img",function(f){var g=f.length,j,h;while(g--){j=f[g];h=j.attr("class");if(h&&h.indexOf("mce-pagebreak")!==-1){j.type=8;j.value="pagebreak"}}})})});