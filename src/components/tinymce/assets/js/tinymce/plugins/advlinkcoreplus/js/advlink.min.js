tinyMCEPopup.requireLangPack();var templates={"window.open":"window.open('${url}','${target}','${options}')"};function preinit(){var a;if(a=tinyMCEPopup.getParam("external_link_list_url")){document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(a)+'"><\/script>')}}function changeClass(){var a=document.forms[0];a.classes.value=getSelectValue(a,"classlist")}function init(){tinyMCEPopup.resizeToInnerSize();var g=document.forms[0];var e=tinyMCEPopup.editor;var h=e.selection.getNode();var c="insert";var f;document.getElementById("hrefbrowsercontainer").innerHTML=getBrowserHTML("hrefbrowser","href","file","advlink");document.getElementById("popupurlbrowsercontainer").innerHTML=getBrowserHTML("popupurlbrowser","popupurl","file","advlink");document.getElementById("targetlistcontainer").innerHTML=getTargetListHTML("targetlist","target");f=getLinkListHTML("linklisthref","href");if(f==""){document.getElementById("linklisthrefrow").style.display="none"}else{document.getElementById("linklisthrefcontainer").innerHTML=f}f=getAnchorListHTML("anchorlist","href");if(f==""){document.getElementById("anchorlistrow").style.display="none"}else{document.getElementById("anchorlistcontainer").innerHTML=f}if(isVisible("hrefbrowser")){document.getElementById("href").style.width="260px"}if(isVisible("popupurlbrowser")){document.getElementById("popupurl").style.width="180px"}h=e.dom.getParent(h,"A");if(h==null){var a=e.dom.create("p",null,e.selection.getContent());if(a.childNodes.length===1){h=a.firstChild}}if(h!=null&&h.nodeName=="A"){c="update"}g.insert.value=tinyMCEPopup.getLang(c,"Insert",true);setPopupControlsDisabled(true);if(c=="update"){var b=e.dom.getAttrib(h,"href"),k=e.dom.getAttrib(h,"onclick"),l=false,j,d;j=document.forms[0].elements.hrefselect;for(d=0;d<j.options.length;d++){if(j.options[d].value==b){l=true;j.options[d].selected="selected";break}}if(!l){setFormValue("href",b)}setFormValue("title",e.dom.getAttrib(h,"title"));setFormValue("id",e.dom.getAttrib(h,"id"));setFormValue("style",e.dom.getAttrib(h,"style"));setFormValue("rel",e.dom.getAttrib(h,"rel"));setFormValue("rev",e.dom.getAttrib(h,"rev"));setFormValue("charset",e.dom.getAttrib(h,"charset"));setFormValue("hreflang",e.dom.getAttrib(h,"hreflang"));setFormValue("dir",e.dom.getAttrib(h,"dir"));setFormValue("lang",e.dom.getAttrib(h,"lang"));setFormValue("tabindex",e.dom.getAttrib(h,"tabindex",typeof(h.tabindex)!="undefined"?h.tabindex:""));setFormValue("accesskey",e.dom.getAttrib(h,"accesskey",typeof(h.accesskey)!="undefined"?h.accesskey:""));setFormValue("type",e.dom.getAttrib(h,"type"));setFormValue("onfocus",e.dom.getAttrib(h,"onfocus"));setFormValue("onblur",e.dom.getAttrib(h,"onblur"));setFormValue("onclick",k);setFormValue("ondblclick",e.dom.getAttrib(h,"ondblclick"));setFormValue("onmousedown",e.dom.getAttrib(h,"onmousedown"));setFormValue("onmouseup",e.dom.getAttrib(h,"onmouseup"));setFormValue("onmouseover",e.dom.getAttrib(h,"onmouseover"));setFormValue("onmousemove",e.dom.getAttrib(h,"onmousemove"));setFormValue("onmouseout",e.dom.getAttrib(h,"onmouseout"));setFormValue("onkeypress",e.dom.getAttrib(h,"onkeypress"));setFormValue("onkeydown",e.dom.getAttrib(h,"onkeydown"));setFormValue("onkeyup",e.dom.getAttrib(h,"onkeyup"));setFormValue("target",e.dom.getAttrib(h,"target"));setFormValue("classes",e.dom.getAttrib(h,"class"));if(k!=null&&k.indexOf("window.open")!=-1){parseWindowOpen(k)}else{parseFunction(k)}selectByValue(g,"dir",e.dom.getAttrib(h,"dir"));selectByValue(g,"rel",e.dom.getAttrib(h,"rel"));selectByValue(g,"rev",e.dom.getAttrib(h,"rev"));selectByValue(g,"linklisthref",b);if(b.charAt(0)=="#"){selectByValue(g,"anchorlist",b)}addClassesToList("classlist","advlink_styles");selectByValue(g,"classlist",e.dom.getAttrib(h,"class"),true);selectByValue(g,"targetlist",e.dom.getAttrib(h,"target"),true)}else{addClassesToList("classlist","advlink_styles")}}function checkPrefix(a){if(a.value&&Validator.isEmail(a)&&!/^\s*mailto:/i.test(a.value)&&confirm(tinyMCEPopup.getLang("advlink_dlg.is_email"))){a.value="mailto:"+a.value}if(/^\s*www\./i.test(a.value)&&confirm(tinyMCEPopup.getLang("advlink_dlg.is_external"))){a.value="http://"+a.value}}function setFormValue(a,b){document.forms[0].elements[a].value=b}function parseWindowOpen(c){var a=document.forms[0];if(c.indexOf("return false;")!=-1){a.popupreturn.checked=true;c=c.replace("return false;","")}else{a.popupreturn.checked=false}var e=parseLink(c);if(e!=null){a.ispopup.checked=true;setPopupControlsDisabled(false);var d=parseOptions(e.options);var b=e.url;a.popupname.value=e.target;a.popupurl.value=b;a.popupwidth.value=getOption(d,"width");a.popupheight.value=getOption(d,"height");a.popupleft.value=getOption(d,"left");a.popuptop.value=getOption(d,"top");if(a.popupleft.value.indexOf("screen")!=-1){a.popupleft.value="c"}if(a.popuptop.value.indexOf("screen")!=-1){a.popuptop.value="c"}a.popuplocation.checked=getOption(d,"location")=="yes";a.popupscrollbars.checked=getOption(d,"scrollbars")=="yes";a.popupmenubar.checked=getOption(d,"menubar")=="yes";a.popupresizable.checked=getOption(d,"resizable")=="yes";a.popuptoolbar.checked=getOption(d,"toolbar")=="yes";a.popupstatus.checked=getOption(d,"status")=="yes";a.popupdependent.checked=getOption(d,"dependent")=="yes";buildOnClick()}}function parseFunction(b){var a=document.forms[0];var c=parseLink(b)}function getOption(b,a){return typeof(b[a])=="undefined"?"":b[a]}function setPopupControlsDisabled(b){var a=document.forms[0];a.popupname.disabled=b;a.popupurl.disabled=b;a.popupwidth.disabled=b;a.popupheight.disabled=b;a.popupleft.disabled=b;a.popuptop.disabled=b;a.popuplocation.disabled=b;a.popupscrollbars.disabled=b;a.popupmenubar.disabled=b;a.popupresizable.disabled=b;a.popuptoolbar.disabled=b;a.popupstatus.disabled=b;a.popupreturn.disabled=b;a.popupdependent.disabled=b;setBrowserDisabled("popupurlbrowser",b)}function parseLink(f){f=f.replace(new RegExp("&#39;","g"),"'");var a=f.replace(new RegExp("\\s*([A-Za-z0-9.]*)\\s*\\(.*","gi"),"$1");var h=templates[a];if(h){var g=h.match(new RegExp("'?\\$\\{[A-Za-z0-9.]*\\}'?","gi"));var e="\\s*[A-Za-z0-9.]*\\s*\\(";var d="";for(var c=0;c<g.length;c++){if(g[c].indexOf("'${")!=-1){e+="'(.*)'"}else{e+="([0-9]*)"}d+="$"+(c+1);g[c]=g[c].replace(new RegExp("[^A-Za-z0-9]","gi"),"");if(c!=g.length-1){e+="\\s*,\\s*";d+="<delim>"}else{e+=".*"}}e+="\\);?";var j=[];j._function=a;var b=f.replace(new RegExp(e,"gi"),d).split("<delim>");for(var c=0;c<g.length;c++){j[g[c]]=b[c]}return j}return null}function parseOptions(c){if(c==null||c==""){return[]}c=c.toLowerCase();c=c.replace(/;/g,",");c=c.replace(/[^0-9a-z=,]/g,"");var e=c.split(",");var a=[];for(var b=0;b<e.length;b++){var d=e[b].split("=");if(d.length==2){a[d[0]]=d[1]}}return a}function buildOnClick(){var a=document.forms[0];if(!a.ispopup.checked){a.onclick.value="";return}var c="window.open('";var b=a.popupurl.value;c+=b+"','";c+=a.popupname.value+"','";if(a.popuplocation.checked){c+="location=yes,"}if(a.popupscrollbars.checked){c+="scrollbars=yes,"}if(a.popupmenubar.checked){c+="menubar=yes,"}if(a.popupresizable.checked){c+="resizable=yes,"}if(a.popuptoolbar.checked){c+="toolbar=yes,"}if(a.popupstatus.checked){c+="status=yes,"}if(a.popupdependent.checked){c+="dependent=yes,"}if(a.popupwidth.value!=""){c+="width="+a.popupwidth.value+","}if(a.popupheight.value!=""){c+="height="+a.popupheight.value+","}if(a.popupleft.value!=""){if(a.popupleft.value!="c"){c+="left="+a.popupleft.value+","}else{c+="left='+(screen.availWidth/2-"+(a.popupwidth.value/2)+")+',"}}if(a.popuptop.value!=""){if(a.popuptop.value!="c"){c+="top="+a.popuptop.value+","}else{c+="top='+(screen.availHeight/2-"+(a.popupheight.value/2)+")+',"}}if(c.charAt(c.length-1)==","){c=c.substring(0,c.length-1)}c+="');";if(a.popupreturn.checked){c+="return false;"}a.onclick.value=c;if(a.href.value==""){a.href.value=b}}function setAttrib(f,d,c){var b=document.forms[0];var a=b.elements[d.toLowerCase()];var e=tinyMCEPopup.editor.dom;if(typeof(c)=="undefined"||c==null){c="";if(a){c=a.value}}if(d=="style"){c=e.serializeStyle(e.parseStyle(c),"a")}e.setAttrib(f,d,c)}function getAnchorListHTML(h,g){var c=tinyMCEPopup.editor,b=c.dom.select("a"),d,f,a,e="";for(f=0,a=b.length;f<a;f++){if((d=c.dom.getAttrib(b[f],"name"))!=""){e+='<option value="#'+d+'">'+d+"</option>"}}if(e==""){return""}e='<select id="'+h+'" name="'+h+'" class="mceAnchorList" onchange="this.form.'+g+'.value=this.options[this.selectedIndex].value"><option value="">---</option>'+e+"</select>";return e}function insertAction(){var d=tinyMCEPopup.editor,e,a,c,b;e=d.selection.getNode();checkPrefix(document.forms[0].href);if(document.forms[0].hrefselect.value){b=document.forms[0].hrefselect.value}else{b=document.forms[0].href.value}e=d.dom.getParent(e,"A");if(!b){c=d.selection.getBookmark();d.dom.remove(e,1);d.selection.moveToBookmark(c);tinyMCEPopup.execCommand("mceEndUndoLevel");tinyMCEPopup.close();return}if(e==null){d.getDoc().execCommand("unlink",false,null);tinyMCEPopup.execCommand("mceInsertLink",false,"#mce_temp_url#",{skip_undo:1});a=tinymce.grep(d.dom.select("a"),function(f){return d.dom.getAttrib(f,"href")=="#mce_temp_url#"});for(c=0;c<a.length;c++){setAllAttribs(e=a[c])}}else{setAllAttribs(e)}if(e.childNodes.length!=1||e.firstChild.nodeName!="IMG"){d.focus();d.selection.select(e);d.selection.collapse(0);tinyMCEPopup.storeSelection()}tinyMCEPopup.execCommand("mceEndUndoLevel");tinyMCEPopup.close()}function setAllAttribs(d){var a=document.forms[0],b,c=getSelectValue(a,"targetlist");if(a.hrefselect.value){b=a.hrefselect.value}else{b=a.href.value}b=b.replace(/ /g,"%20");setAttrib(d,"href",b);setAttrib(d,"title");setAttrib(d,"target",c=="_self"?"":c);setAttrib(d,"id");setAttrib(d,"style");setAttrib(d,"class",getSelectValue(a,"classlist"));setAttrib(d,"rel");setAttrib(d,"rev");setAttrib(d,"charset");setAttrib(d,"hreflang");setAttrib(d,"dir");setAttrib(d,"lang");setAttrib(d,"tabindex");setAttrib(d,"accesskey");setAttrib(d,"type");setAttrib(d,"onfocus");setAttrib(d,"onblur");setAttrib(d,"onclick");setAttrib(d,"ondblclick");setAttrib(d,"onmousedown");setAttrib(d,"onmouseup");setAttrib(d,"onmouseover");setAttrib(d,"onmousemove");setAttrib(d,"onmouseout");setAttrib(d,"onkeypress");setAttrib(d,"onkeydown");setAttrib(d,"onkeyup");if(tinyMCE.isMSIE5){d.outerHTML=d.outerHTML}}function getSelectValue(a,b){var c=a.elements[b];if(!c||c.options==null||c.selectedIndex==-1){return""}return c.options[c.selectedIndex].value}function getLinkListHTML(d,c,e){if(typeof(tinyMCELinkList)=="undefined"||tinyMCELinkList.length==0){return""}var b="";b+='<select id="'+d+'" name="'+d+'"';b+=' class="mceLinkList" onchange="this.form.'+c+".value=";b+="this.options[this.selectedIndex].value;";if(typeof(e)!="undefined"){b+=e+"('"+c+"',this.options[this.selectedIndex].text,this.options[this.selectedIndex].value);"}b+='"><option value="">---</option>';for(var a=0;a<tinyMCELinkList.length;a++){b+='<option value="'+tinyMCELinkList[a][1]+'">'+tinyMCELinkList[a][0]+"</option>"}b+="</select>";return b}function getTargetListHTML(f,e){var a=tinyMCEPopup.getParam("theme_advanced_link_targets","").split(";");var d="";d+='<select id="'+f+'" name="'+f+'" onchange="this.form.'+e+".value=";d+='this.options[this.selectedIndex].value;">';d+='<option value="_self">'+tinyMCEPopup.getLang("advlink_dlg.target_same")+"</option>";d+='<option value="_blank">'+tinyMCEPopup.getLang("advlink_dlg.target_blank")+" (_blank)</option>";d+='<option value="_parent">'+tinyMCEPopup.getLang("advlink_dlg.target_parent")+" (_parent)</option>";d+='<option value="_top">'+tinyMCEPopup.getLang("advlink_dlg.target_top")+" (_top)</option>";for(var c=0;c<a.length;c++){var b,g;if(a[c]==""){continue}b=a[c].split("=")[0];g=a[c].split("=")[1];d+='<option value="'+b+'">'+g+" ("+b+")</option>"}d+="</select>";return d}preinit();tinyMCEPopup.onInit.add(init);